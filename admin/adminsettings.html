<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>إعدادات المنصة - تكوين</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../style.css">
  <script defer src="../scripts/core.js"></script>
</head>
<body>
  <header class="header-hero">
    <h1>إعدادات المنصة</h1>
    <p>تحكم كامل بالهوية البصرية، الرسائل، القيم، وبيانات التواصل</p>
  </header>

  <nav>
    <a href="../index.html">الرئيسية</a>
    <a href="../jobs.html">الوظائف</a>
    <a href="../companies.html">الشركات</a>
    <a href="../jobseekers.html">الباحثين</a>
    <a href="dashboard.html">لوحة التحكم</a>
    <div class="nav-tools"><button class="btn" onclick="toggleDarkMode()">الوضع الليلي</button></div>
  </nav>

  <main class="main">
    <section class="card">
      <h2 class="section-title">تعديل الإعدادات</h2>
      <form id="settings-form">
        <label>اسم المنصة</label><input id="brand_name" type="text">
        <label>اللون الأساسي</label><input id="primary_color" type="text" placeholder="#0b2c55">
        <label>اللون الثانوي</label><input id="secondary_color" type="text" placeholder="#103a70">
        <label>اللون المميز</label><input id="accent_color" type="text" placeholder="#FFD700">
        <label>رسالة الفريق</label><textarea id="team_message" rows="3"></textarea>
        <label>القيم (كل قيمة بسطر)</label><textarea id="team_values" rows="3"></textarea>
        <label>الهاتف</label><input id="contact_phone" type="text">
        <label>البريد الإلكتروني</label><input id="contact_email" type="email">
        <label>رابط Facebook</label><input id="facebook" type="url">
        <label>رابط Instagram</label><input id="instagram" type="url">
        <label>رابط LinkedIn</label><input id="linkedin" type="url">
        <button class="btn" type="submit">حفظ الإعدادات</button>
      </form>
    </section>
  </main>

  <div class="toast"></div>
  <footer class="footer">© 2025 منصة تكوين</footer>

  <script>
    async function loadSettings() {
      const res = await fetch('/api/settings');
      const s = await res.json();
      brand_name.value = s.brand_name || '';
      primary_color.value = s.primary_color || '';
      secondary_color.value = s.secondary_color || '';
      accent_color.value = s.accent_color || '';
      team_message.value = s.team_message || '';
      team_values.value = (s.team_values || []).join('\n');
      contact_phone.value = s.contact_phone || '';
      contact_email.value = s.contact_email || '';
      facebook.value = s.social_links?.facebook || '';
      instagram.value = s.social_links?.instagram || '';
      linkedin.value = s.social_links?.linkedin || '';
    }

    document.getElementById('settings-form').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const payload = {
        brand_name: brand_name.value,
        primary_color: primary_color.value,
        secondary_color: secondary_color.value,
        accent_color: accent_color.value,
        team_message: team_message.value,
        team_values: team_values.value.split('\n').map(v=>v.trim()).filter(Boolean),
        contact_phone: contact_phone.value,
        contact_email: contact_email.value,
        social_links: { facebook: facebook.value, instagram: instagram.value, linkedin: linkedin.value }
      };
      const res = await fetch('/api/settings', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload) });
      const j = await res.json();
      showToast(j.message || j.error || 'تم');
    });

    document.addEventListener('DOMContentLoaded', loadSettings);
  </script>
</body>
</html>
